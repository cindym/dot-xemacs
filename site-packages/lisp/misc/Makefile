.SUFFIXES: .el .elc

EMACS ?= xemacs

.el.elc:
	$(EMACS) -batch -q -l batch-helper.el -f batch-byte-compile $<

ELCS =  browse-kill-ring.elc\
	find-file.elc\
	gopher.elc\
	greedy-delete.elc\
	libc-mode.elc\
	ws-trim.elc\

ifneq ($(findstring xemacs,$(EMACS)),)
EXTRA = auto-autoloads.elc
else
EXTRA = sam-loaddefs.el
endif

all:	$(ELCS) $(EXTRA)

auto-autoloads.el: $(ELCS)
	rm -f auto-autoloads.el
ifeq ($(EMACS),sxemacs)
	$(EMACS) -batch -f batch-create-autoloads .
else
	$(EMACS) -batch -q -no-site-file -l autoload -f batch-update-directory .
endif

sam-loaddefs.el:
	$(EMACS) -batch -q -l batch-helper.el -l build-loaddefs.el -f build-loaddefs

tags:
	etags *.el

clean:
	rm -f *.elc auto-autoloads.el TAGS
